version: v1.0
name: Run in Docker
agent:
  machine:
    type: e1-standard-2
  containers:
    - name: main
      image: 'hossam1522/modatrack'

blocks:
  - name: Tests
    task:
      jobs:
        - name: Actualizar versiÃ³n de Go en go.mod
          matrix:
            - env_var: GO_VERSION
              values:
                - "1.11"
                - "1.23.4"
          commands:
            - checkout
            - go mod edit -go $GO_VERSION
            - wget -q https://go.dev/dl/go$GO_VERSION.linux-amd64.tar.gz
            - mkdir -p $HOME/go_new
            - tar -C $HOME/go_new -xzf go$GO_VERSION.linux-amd64.tar.gz
            - rm go$GO_VERSION.linux-amd64.tar.gz
            - echo 'export PATH=$HOME/go_new/go/bin:$PATH' >> $BASH_ENV
            - source $BASH_ENV
            - go version
            - task test
